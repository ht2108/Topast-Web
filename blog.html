<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>Topast - Blog</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;500;600;700&family=Montserrat:wght@300;400;500;600;700&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            navy: "#10243E",
            cream: "#F8F4E8",
            gold: "#C59C5F",
            pastel: "#EBE8D5",
            tomato: "#BF3B2C",
            blue: {
              light: "#4168a8",
              dark: "#10243E",
              topast: "#2b5ea3"
            },
            primary: '#4168a8',
            secondary: '#10243E'
          },
          fontFamily: {
            serif: ["EB Garamond", "serif"],
            sans: ["Montserrat", "sans-serif"],
            script: ["Dancing Script", "cursive"],
          },
        },
      },
    };
  </script>
  <style>
    body {
      background-color: #F8F4E8;
    }
    /* Add typography plugin styles inline since we can't use the plugin with CDN */
    .prose {
      max-width: 65ch;
      color: #374151;
    }
    .prose p, .prose ul, .prose ol {
      margin-top: 1.25em;
      margin-bottom: 1.25em;
    }
    .prose img {
      margin-top: 2em;
      margin-bottom: 2em;
    }
    .prose h2 {
      margin-top: 2em;
      margin-bottom: 1em;
      font-weight: 700;
      font-size: 1.5em;
      color: #10243E;
    }
    .prose h3 {
      margin-top: 1.6em;
      margin-bottom: 0.6em;
      font-weight: 600;
      font-size: 1.25em;
      color: #10243E;
    }
    .prose a {
      color: #4168a8;
      text-decoration: underline;
      font-weight: 500;
    }
    .prose a:hover {
      color: #10243E;
    }
    .prose-lg {
      font-size: 1.125rem;
      line-height: 1.7777778;
    }
    .prose-lg p {
      margin-top: 1.3333333em;
      margin-bottom: 1.3333333em;
    }
    .prose-lg h2 {
      margin-top: 1.8888889em;
      margin-bottom: 0.8888889em;
      font-size: 1.6666667em;
      line-height: 1.3;
    }
    .vertical-text {
      writing-mode: vertical-rl;
      text-orientation: mixed;
      transform: rotate(180deg);
    }
    .article-link {
      font-style: italic;
      font-family: 'EB Garamond', serif;
      font-size: 1.5rem;
      color: #10243E;
      display: block;
      margin-bottom: 1.5rem;
      transition: color 0.3s ease;
    }
    .article-link:hover {
      color: #4168a8;
    }
    .main-heading {
      font-family: 'EB Garamond', serif;
      font-size: 2.5rem;
      color: #10243E;
      text-transform: uppercase;
      margin-bottom: 3rem;
    }
    .blog-title {
      font-family: 'Dancing Script', cursive;
      font-size: 3rem;
      color: white;
      text-align: center;
      padding: 0.5rem 0;
    }
    .section-title {
      font-family: 'EB Garamond', serif;
      font-size: 2rem;
      color: #10243E;
      font-weight: 700;
      margin-bottom: 1rem;
    }
    .topast-header {
      background-color: #2b5ea3;
      color: white;
      padding: 1rem 0;
      text-align: center;
    }
    .article-card {
      transition: transform 0.2s ease-in-out;
    }
    .article-card:hover {
      transform: translateY(-5px);
    }
    .max-w-none {
      max-width: none;
    }
    [v-cloak] {
      display: none;
    }
    /* Analytics Dashboard */
    .analytics-panel {
      position: fixed;
      top: 0;
      right: 0;
      width: 320px;
      height: 100vh;
      background-color: #fff;
      box-shadow: -2px 0 10px rgba(0,0,0,0.1);
      padding: 1rem;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      overflow-y: auto;
      z-index: 1000;
    }
    .analytics-panel.open {
      transform: translateX(0);
    }
    .analytics-toggle {
      position: fixed;
      top: 50%;
      right: 0;
      transform: translateY(-50%);
      background-color: #2b5ea3;
      color: white;
      padding: 0.5rem;
      border-top-left-radius: 4px;
      border-bottom-left-radius: 4px;
      cursor: pointer;
      z-index: 1001;
    }
    .stat-card {
      background-color: #f5f7fa;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .stat-title {
      font-size: 0.875rem;
      color: #6b7280;
      margin-bottom: 0.5rem;
    }
    .stat-value {
      font-size: 1.5rem;
      font-weight: 600;
      color: #10243E;
    }
    .chart-container {
      height: 200px;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="bg-blue-50 py-4">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center">
        <!-- Logo -->
        <div class="flex-shrink-0">
          <a href="index.html" class="flex items-center">
            <h1 class="text-3xl font-serif font-bold">
              <span class="text-navy">Top</span><span class="text-blue-500">ast</span><span class="text-navy">..</span>
            </h1>
          </a>
        </div>

        <!-- Search and Cart -->
        <div class="flex items-center space-x-4">
          <div class="relative flex items-center">
            <button class="absolute left-3 text-gray-500">
              <i class="fas fa-search"></i>
            </button>
            <input type="text" placeholder="SEARCH & SHOP" class="border border-gray-300 rounded-full px-10 py-1 text-sm w-56 bg-white">
          </div>
          <a href="#" class="text-navy">
            <i class="fas fa-shopping-bag text-xl"></i>
          </a>
          <div class="w-12 h-6 bg-red-600 rounded"></div>
        </div>
      </div>

      <!-- Navigation -->
      <div class="mt-4 flex flex-wrap justify-center">
        <a href="index.html#about" class="m-1 px-6 py-2 rounded-full bg-blue-50 border border-blue-100 text-navy hover:bg-blue-100 transition">ABOUT US</a>
        <a href="index.html#menu" class="m-1 px-6 py-2 rounded-full bg-blue-50 border border-blue-100 text-navy hover:bg-blue-100 transition">OUR MENU</a>
        <a href="index.html#events" class="m-1 px-6 py-2 rounded-full bg-blue-50 border border-blue-100 text-navy hover:bg-blue-100 transition">GIFTS</a>
        <a href="index.html#testimonials" class="m-1 px-6 py-2 rounded-full bg-blue-50 border border-blue-100 text-navy hover:bg-blue-100 transition">TESTIMONIAL</a>
        <a href="index.html#find" class="m-1 px-6 py-2 rounded-full bg-blue-50 border border-blue-100 text-navy hover:bg-blue-100 transition">FIND US</a>
        <a href="#" onclick="router.navigate('/blog'); return false;" class="m-1 px-6 py-2 rounded-full bg-blue-200 border border-blue-200 text-navy font-medium">FIND AN ARTICLE</a>
      </div>

      <!-- Mobile Navigation (hidden by default) -->
      <div id="mobile-menu" class="hidden mt-4">
        <div class="space-y-2 bg-blue-50 p-4 rounded-lg">
          <div class="flex items-center mb-4 relative">
            <i class="fas fa-search absolute left-3 text-gray-500"></i>
            <input type="text" placeholder="SEARCH & SHOP" class="border border-gray-300 rounded-full pl-10 pr-4 py-1 text-sm w-full">
          </div>
          <a href="index.html#about" class="block py-2 text-navy font-medium">ABOUT US</a>
          <a href="index.html#menu" class="block py-2 text-navy font-medium">OUR MENU</a>
          <a href="index.html#events" class="block py-2 text-navy font-medium">GIFTS</a>
          <a href="index.html#testimonials" class="block py-2 text-navy font-medium">TESTIMONIAL</a>
          <a href="index.html#find" class="block py-2 text-navy font-medium">FIND US</a>
          <a href="#" onclick="router.navigate('/blog'); return false;" class="block py-2 text-navy font-medium">FIND AN ARTICLE</a>
          <a href="#" class="block py-2 text-navy font-medium">
            <i class="fas fa-shopping-bag mr-2"></i>View Cart
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Analytics Toggle Button -->
  <div class="analytics-toggle" onclick="toggleAnalyticsPanel()">
    <i class="fas fa-chart-line"></i>
  </div>

  <!-- Analytics Panel -->
  <div id="analytics-panel" class="analytics-panel">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-bold">Analytics Dashboard</h3>
      <button onclick="toggleAnalyticsPanel()" class="text-gray-500 hover:text-gray-700">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="grid grid-cols-2 gap-2 mb-4">
      <div class="stat-card">
        <div class="stat-title">Total Visits</div>
        <div class="stat-value" id="total-visits">1,423</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">Avg. Time on Page</div>
        <div class="stat-value" id="avg-time">3:12</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">Bounce Rate</div>
        <div class="stat-value" id="bounce-rate">35.2%</div>
      </div>
      <div class="stat-card">
        <div class="stat-title">Conversion Rate</div>
        <div class="stat-value" id="conversion-rate">4.2%</div>
      </div>
    </div>

    <h4 class="font-semibold mb-2">Traffic Sources</h4>
    <div class="chart-container mb-4 bg-white p-3 rounded-lg">
      <div id="traffic-sources-chart" class="h-full"></div>
    </div>

    <h4 class="font-semibold mb-2">Recent Page Views</h4>
    <div id="recent-pageviews" class="bg-white p-3 rounded-lg mb-4">
      <!-- Will be filled dynamically -->
      <div class="text-sm text-gray-600">Loading...</div>
    </div>

    <h4 class="font-semibold mb-2">Top Posts by Views</h4>
    <div id="top-posts" class="bg-white p-3 rounded-lg">
      <!-- Will be filled dynamically -->
      <div class="text-sm text-gray-600">Loading...</div>
    </div>
  </div>

  <!-- Main App Content -->
  <main id="app" v-cloak>
    <!-- Blog Listing View -->
    <div v-if="currentView === 'blog'">
      <div class="py-16">
        <div class="max-w-6xl mx-auto px-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <div>
              <h1 class="text-4xl text-navy font-serif uppercase mb-12">FIND AN ARTICLE</h1>
              
              <div>
                <a v-for="post in blogPosts" :key="post.id" href="#" @click.prevent="showPost(post.id)" class="article-link">{{ post.title }}</a>
              </div>
            </div>
            
            <div>
              <img src="https://images.unsplash.com/photo-1509440159596-0249088772ff?q=80&w=1472&auto=format&fit=crop" 
                  alt="Topast spread with various pastries" 
                  class="rounded-lg w-full object-cover">
            </div>
          </div>
          
          <!-- Featured Articles Section -->
          <div class="mt-20">
            <h2 class="text-3xl font-serif text-navy mb-12 text-center">Featured Articles</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
              <!-- Featured Articles -->
              <div v-for="post in featuredPosts" :key="post.id" class="bg-white rounded-lg shadow-lg overflow-hidden">
                <img :src="post.featuredImage" 
                    :alt="post.title" 
                    class="w-full h-48 object-cover">
                <div class="p-6">
                  <div class="flex items-center text-sm text-gray-500 mb-3">
                    <span>{{ post.date }}</span>
                    <span class="mx-2">•</span>
                    <span>{{ post.category }}</span>
                  </div>
                  <h3 class="text-xl font-bold text-navy mb-3">{{ post.title }}</h3>
                  <p class="text-gray-600 mb-4">{{ post.excerpt }}</p>
                  <a href="#" @click.prevent="showPost(post.id)" class="text-blue-light font-medium flex items-center">
                    Read More
                    <i class="fas fa-arrow-right ml-2 text-sm"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
          
          <!-- External Articles Link -->
          <div class="mt-20 text-center">
            <a href="#" @click.prevent="router.navigate('/articles')" class="inline-block px-8 py-4 bg-blue-700 text-white rounded-lg shadow hover:bg-blue-800 transition-colors font-medium text-lg">
              View External Articles
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Blog Post View -->
    <div v-if="currentView === 'post' && currentPost">
      <!-- Blog Header -->
      <div class="topast-header py-8">
        <div class="container mx-auto px-4">
          <h2 class="text-center text-white text-3xl font-bold mb-4">TOPAST BLOG</h2>
          <h1 class="blog-title">{{ currentPost.title }}</h1>
        </div>
      </div>

      <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Introduction Section -->
        <div class="bg-white p-8 rounded-lg shadow-md mb-8">
          <div class="flex flex-col md:flex-row gap-8">
            <div class="w-full">
              <p class="text-gray-800 leading-relaxed" v-html="currentPost.introContent"></p>
            </div>
          </div>
          
          <div class="mt-6">
            <img :src="currentPost.featuredImage" 
                 :alt="currentPost.title" 
                 class="w-full h-auto object-cover rounded-lg">
          </div>
        </div>

        <!-- Why Choose Topast Section -->
        <div v-if="currentPost.whyChooseTopast" class="bg-white p-8 rounded-lg shadow-md mb-8">
          <h2 class="section-title">KENAPA HARUS PILIH TOPAST?</h2>
          
          <div class="flex flex-col md:flex-row gap-8">
            <div class="md:w-1/2">
              <!-- Product Images Grid -->
              <div class="grid grid-cols-2 gap-4">
                <img v-for="(img, index) in currentPost.productImages" :key="index" 
                     :src="img.src" 
                     :alt="img.alt" 
                     class="rounded-lg shadow-sm w-full h-48 object-cover">
              </div>
            </div>
            
            <div class="md:w-1/2">
              <p class="text-gray-800 leading-relaxed" v-html="currentPost.whyChooseTopast"></p>
            </div>
          </div>
        </div>

        <!-- Composition Section -->
        <div v-if="currentPost.composition" class="bg-white p-8 rounded-lg shadow-md mb-8">
          <h2 class="section-title">KOMPOSISI</h2>
          
          <p class="text-gray-800 leading-relaxed" v-html="currentPost.composition"></p>
        </div>

        <!-- Complementary Food Section -->
        <div v-if="currentPost.complementaryFood" class="bg-white p-8 rounded-lg shadow-md mb-8">
          <div class="flex flex-col md:flex-row gap-8">
            <div class="md:w-1/2">
              <h2 class="section-title">MAKANAN PENDAMPING KAMU</h2>
              
              <p class="text-gray-800 leading-relaxed mb-6" v-html="currentPost.complementaryFood"></p>
            </div>
            
            <div class="md:w-1/2">
              <img :src="currentPost.complementaryFoodImage" 
                   alt="Complementary food" 
                   class="rounded-lg shadow-md w-full h-auto object-cover">
            </div>
          </div>
        </div>

        <!-- Special Variants Section -->
        <div v-if="currentPost.specialVariants" class="bg-white p-8 rounded-lg shadow-md mb-8">
          <div class="flex flex-col md:flex-row gap-8">
            <div class="md:w-1/2">
              <h2 class="section-title">MATCHA KUNAFA VS KLEPON</h2>
              
              <p class="text-gray-800 leading-relaxed mb-6" v-html="currentPost.specialVariants"></p>
              
              <div class="text-center mt-8">
                <a href="#variants" class="inline-block px-6 py-3 bg-blue-topast text-white rounded shadow hover:bg-blue-800 transition-colors font-medium text-lg">
                  Click here to see other Variants
                </a>
              </div>
            </div>
            
            <div class="md:w-1/2">
              <img :src="currentPost.specialVariantsImage" 
                   alt="Special variants" 
                   class="rounded-lg shadow-md w-full h-auto object-cover">
            </div>
          </div>
        </div>
        
        <!-- Additional Content Section -->
        <div v-if="currentPost.additionalContent" class="bg-white p-8 rounded-lg shadow-md mb-8">
          <div v-html="currentPost.additionalContent"></div>
        </div>
        
        <!-- Related Articles -->
        <div class="mt-16">
          <h3 class="text-2xl font-serif font-bold text-navy mb-8">Related Articles</h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Related Articles -->
            <a v-for="post in relatedPosts" :key="post.id" href="#" @click.prevent="showPost(post.id)" class="block group">
              <div class="bg-white rounded-lg shadow-md overflow-hidden transition-all duration-300 group-hover:shadow-lg">
                <img :src="post.featuredImage" 
                     :alt="post.title" 
                     class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105">
                <div class="p-4">
                  <h4 class="font-bold text-navy group-hover:text-blue-light transition-colors">{{ post.title }}</h4>
                  <p class="text-sm text-gray-600 mt-2">{{ post.date }}</p>
                </div>
              </div>
            </a>
          </div>
        </div>
        
        <!-- Back to blog link -->
        <div class="text-center mt-12">
          <a href="#" @click.prevent="router.navigate('/blog')" class="inline-flex items-center text-blue-light font-medium">
            <i class="fas fa-arrow-left mr-2"></i> Back to all articles
          </a>
        </div>
      </div>
    </div>

    <!-- External Articles View -->
    <div v-if="currentView === 'articles'">
      <main class="container mx-auto px-4 py-12">
        <div class="text-center mb-12">
          <h1 class="text-3xl md:text-4xl font-serif font-bold text-navy mb-4">External Articles</h1>
          <p class="text-gray-600 max-w-2xl mx-auto">Explore these curated articles from around the web about pastry, baking, and food innovations.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <!-- External Articles -->
          <div v-for="article in externalArticles" :key="article.id" class="article-card bg-white rounded-lg shadow overflow-hidden">
            <img :src="article.image" :alt="article.title" class="w-full h-48 object-cover">
            <div class="p-6">
              <div class="flex items-center text-sm text-gray-500 mb-3">
                <span>{{ article.date }}</span>
                <span class="mx-2">•</span>
                <span>{{ article.source }}</span>
              </div>
              <h2 class="text-xl font-bold text-secondary mb-3">{{ article.title }}</h2>
              <p class="text-gray-600 mb-4">{{ article.excerpt }}</p>
              <a :href="article.url" target="_blank" rel="noopener noreferrer" class="text-primary font-medium flex items-center">
                {{ article.linkText }}
                <i class="fas fa-external-link-alt ml-2 text-sm"></i>
              </a>
            </div>
          </div>
        </div>
        
        <!-- Back to blog link -->
        <div class="text-center mt-12">
          <a href="#" @click.prevent="router.navigate('/blog')" class="inline-flex items-center text-blue-light font-medium">
            <i class="fas fa-arrow-left mr-2"></i> Back to Topast Articles
          </a>
        </div>
      </main>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-navy text-white py-12 mt-16">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h2 class="text-xl font-bold mb-4">Topast</h2>
          <p class="text-gray-400 mb-4">Pengganjal lapar yang lezat dan kekinian untuk menemani waktu santaimu.</p>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-instagram"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-tiktok"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-facebook"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-twitter"></i>
            </a>
          </div>
        </div>
        
        <div>
          <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
          <ul class="space-y-2">
            <li><a href="index.html" class="text-gray-400 hover:text-white transition-colors">Home</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Products</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Gallery</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Contact</a></li>
          </ul>
        </div>

        <div>
          <h3 class="text-lg font-semibold mb-4">Resources</h3>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">FAQs</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Locations</a></li>
            <li><a href="#" @click.prevent="router.navigate('/blog')" class="text-gray-400 hover:text-white transition-colors">Blog</a></li>
            <li><a href="#" @click.prevent="router.navigate('/articles')" class="text-gray-400 hover:text-white transition-colors">Articles</a></li>
          </ul>
        </div>

        <div>
          <h3 class="text-lg font-semibold mb-4">Newsletter</h3>
          <p class="text-gray-400 mb-4">Subscribe to our newsletter for updates</p>
          <form class="flex flex-col sm:flex-row gap-2">
            <input type="email" placeholder="Your email" class="px-4 py-2 rounded text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-light">
            <button type="submit" class="px-4 py-2 bg-blue-light text-white rounded hover:bg-blue-600 transition-colors">
              Subscribe
            </button>
          </form>
        </div>
      </div>
      <div class="border-t border-gray-700 mt-12 pt-6 text-center text-gray-400">
        <p>&copy; 2024 Topast. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Reset Analytics -->
  <script src="reset-analytics.js"></script>
  
  <!-- Topast Analytics -->
  <script src="analytics.js"></script>
  
  <!-- Load External Blog Data -->
  <script src="blog-data.js"></script>
  
  <!-- Vue.js -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  
  <!-- Application Script -->
  <script>
    // Access the data from the external file
    // These variables are defined in blog-data.js and exposed globally on the window object
    
    // Analytics utility functions
    // Create our own analytics object that uses the TopastAnalytics global from analytics.js
    const analytics = {
      trackPageView: function(page) {
        console.log(`Page view tracked: ${page}`);
        if (window.TopastAnalytics) {
          window.TopastAnalytics.trackPageView();
        } else {
          console.error("TopastAnalytics not found");
        }
      },
      trackEvent: function(category, action, label = null) {
        console.log(`Event tracked: ${category} - ${action}${label ? ' - ' + label : ''}`);
        if (window.TopastAnalytics) {
          window.TopastAnalytics.trackEvent(category, action, label);
        } else {
          console.error("TopastAnalytics not found");
        }
      },
      getAnalyticsData: function() {
        const analyticsKey = 'topast_analytics';
        try {
          return JSON.parse(localStorage.getItem(analyticsKey) || '{}');
        } catch (e) {
          console.error("Error getting analytics data:", e);
          return {};
        }
      }
    };
    
    // Update analytics dashboard
    function updateAnalyticsDashboard() {
      const data = analytics.getAnalyticsData();
      
      // Update page view stats
      const totalVisitsElement = document.getElementById('total-visits');
      if (totalVisitsElement && data.pageViews) {
        const totalVisits = Object.values(data.pageViews).reduce((sum, count) => sum + count, 0);
        totalVisitsElement.textContent = totalVisits.toLocaleString();
      }
      
      // Update recent page views
      const recentPageviewsElement = document.getElementById('recent-pageviews');
      if (recentPageviewsElement && data.pageViews) {
        let html = '';
        const pageViewEntries = Object.entries(data.pageViews);
        
        if (pageViewEntries.length === 0) {
          html = '<div class="text-sm text-gray-600">No page views recorded yet.</div>';
        } else {
          html = '<ul class="space-y-2">';
          pageViewEntries.forEach(([page, count]) => {
            html += `
              <li class="flex justify-between items-center">
                <span class="text-sm">${page}</span>
                <span class="text-sm font-medium">${count} views</span>
              </li>
            `;
          });
          html += '</ul>';
        }
        
        recentPageviewsElement.innerHTML = html;
      }
      
      // Update top posts
      const topPostsElement = document.getElementById('top-posts');
      if (topPostsElement && data.pageViews) {
        let html = '';
        const postViews = {};
        
        // Extract post views
        for (const [key, count] of Object.entries(data.pageViews)) {
          if (key.startsWith('post/')) {
            const postId = key.split('/')[1];
            postViews[postId] = count;
          }
        }
        
        const sortedPosts = Object.entries(postViews)
          .sort(([, countA], [, countB]) => countB - countA)
          .slice(0, 5);
        
        if (sortedPosts.length === 0) {
          html = '<div class="text-sm text-gray-600">No posts viewed yet.</div>';
        } else {
          html = '<ul class="space-y-2">';
          sortedPosts.forEach(([postId, count], index) => {
            // Find post title
            const post = window.blogPostsData.find(p => p.id === parseInt(postId));
            const title = post ? post.title : `Post #${postId}`;
            
            html += `
              <li class="flex justify-between items-center">
                <span class="text-sm">${index + 1}. ${title}</span>
                <span class="text-sm font-medium">${count} views</span>
              </li>
            `;
          });
          html += '</ul>';
        }
        
        topPostsElement.innerHTML = html;
      }
    }
    
    // Toggle analytics panel
    function toggleAnalyticsPanel() {
      const panel = document.getElementById('analytics-panel');
      if (panel) {
        panel.classList.toggle('open');
        updateAnalyticsDashboard();
      }
    }
    
    // Simple router - define before Vue instance is created to avoid the "Can't access lexical declaration" error
    const router = {
      routes: {
        '/blog': 'blog',
        '/post': 'post',
        '/articles': 'articles'
      },
      appInstance: null,
      setAppInstance(instance) {
        this.appInstance = instance;
      },
      navigate(path, params = {}) {
        if (!this.appInstance) {
          console.error('App instance not set in router');
          return;
        }
        
        const route = this.routes[path] || 'blog';
        this.appInstance.currentView = route;
        
        if (route === 'post' && params.id) {
          this.appInstance.currentPostId = params.id;
          this.appInstance.loadCurrentPost();
        }
        
        // Update URL without page reload
        const url = new URL(window.location);
        url.hash = path + (params.id ? `/${params.id}` : '');
        window.history.pushState({}, '', url);
        
        // Scroll to top
        window.scrollTo(0, 0);
      },
      handleInitialRoute() {
        if (!this.appInstance) {
          console.error('App instance not set in router');
          return;
        }
        
        // Parse the current URL
        const hash = window.location.hash.slice(1);
        if (!hash) {
          this.navigate('/blog');
          return;
        }
        
        const parts = hash.split('/');
        const route = parts[0];
        const id = parts[1] ? parseInt(parts[1]) : null;
        
        if (this.routes[route]) {
          this.navigate(route, id ? { id } : {});
        } else {
          this.navigate('/blog');
        }
      }
    };

    // Create Vue App
    const app = Vue.createApp({
      data() {
        return {
          currentView: 'blog',
          currentPostId: null,
          viewCounts: {},
          blogPosts: window.blogPostsData,
          externalArticles: window.externalArticlesData,
          analyticsData: window.analyticsData
        };
      },
      computed: {
        currentPost() {
          if (!this.currentPostId) return null;
          return this.blogPosts.find(post => post.id === this.currentPostId);
        },
        featuredPosts() {
          // Return 3 posts as featured
          return this.blogPosts.slice(0, 3);
        },
        relatedPosts() {
          if (!this.currentPostId) return [];
          // Return 3 posts that are not the current post
          return this.blogPosts
            .filter(post => post.id !== this.currentPostId)
            .slice(0, 3);
        }
      },
      methods: {
        showPost(id) {
          router.navigate('/post', { id });
          analytics.trackEvent('navigation', 'show_post', `id: ${id}`);
        },
        loadCurrentPost() {
          if (!this.currentPostId) return;
          
          // Track page view
          analytics.trackPageView(`post/${this.currentPostId}`);
          
          // Track session length start time
          this.trackSessionStart();
          
          // Update view count
          try {
            // Get current view counts from localStorage
            const viewCountsKey = 'topast_blog_view_counts';
            let viewCounts = JSON.parse(localStorage.getItem(viewCountsKey) || '{}');
            
            // Create a unique key for this post
            const postKey = `post_${this.currentPostId}`;
            
            // Increment the view count
            viewCounts[postKey] = (viewCounts[postKey] || 0) + 1;
            
            // Save back to localStorage
            localStorage.setItem(viewCountsKey, JSON.stringify(viewCounts));
            
            // Store in component data
            this.viewCounts = viewCounts;
          } catch (e) {
            console.error("Error updating view count:", e);
          }
        },
        trackSessionStart() {
          // Store session start time in localStorage
          try {
            const sessionKey = 'topast_blog_session';
            const sessionData = {
              startTime: new Date().getTime(),
              page: this.currentView,
              referrer: document.referrer || 'direct'
            };
            localStorage.setItem(sessionKey, JSON.stringify(sessionData));
          } catch (e) {
            console.error("Error tracking session start:", e);
          }
        },
        trackSessionEnd() {
          // Calculate session duration and store analytics
          try {
            const sessionKey = 'topast_blog_session';
            const sessionDataStr = localStorage.getItem(sessionKey);
            
            if (sessionDataStr) {
              const sessionData = JSON.parse(sessionDataStr);
              const endTime = new Date().getTime();
              const duration = (endTime - sessionData.startTime) / 1000; // in seconds
              
              analytics.trackEvent('session', 'end', `duration: ${duration}s, page: ${sessionData.page}`);
              
              // Clear session data
              localStorage.removeItem(sessionKey);
            }
          } catch (e) {
            console.error("Error tracking session end:", e);
          }
        },
        // Track conversion (newsletter signup, product click, etc.)
        trackConversion(type) {
          analytics.trackEvent('conversion', type);
          
          // You could also show a success message or update UI here
          console.log(`Conversion tracked: ${type}`);
        },
        setupEventTracking() {
          // Track newsletter sign-ups
          const newsletterForms = document.querySelectorAll('form');
          newsletterForms.forEach(form => {
            form.addEventListener('submit', (e) => {
              e.preventDefault();
              this.trackConversion('newsletter-signup');
              form.reset();
              alert('Thanks for subscribing!');
            });
          });
          
          // Track product clicks
          const productLinks = document.querySelectorAll('a[href*="#variants"]');
          productLinks.forEach(link => {
            link.addEventListener('click', () => {
              analytics.trackEvent('product', 'click', 'variant-selection');
            });
          });
          
          // Track social media clicks
          const socialLinks = document.querySelectorAll('a[href*="instagram"], a[href*="facebook"], a[href*="twitter"], a[href*="tiktok"]');
          socialLinks.forEach(link => {
            link.addEventListener('click', (e) => {
              const platform = link.href.includes('instagram') ? 'instagram' : 
                               link.href.includes('facebook') ? 'facebook' :
                               link.href.includes('twitter') ? 'twitter' : 'tiktok';
              analytics.trackEvent('social', 'click', platform);
            });
          });
        }
      },
      mounted() {
        // Handle initial route
        router.handleInitialRoute();
        
        // Set up navigation listener
        window.addEventListener('popstate', () => {
          router.handleInitialRoute();
        });
        
        // Load view counts from localStorage
        try {
          const viewCountsKey = 'topast_blog_view_counts';
          this.viewCounts = JSON.parse(localStorage.getItem(viewCountsKey) || '{}');
        } catch (e) {
          console.error("Error loading view counts:", e);
        }
        
        // Track page view on initial load
        analytics.trackPageView(this.currentView);
        this.trackSessionStart();
        
        // Add event listener for when user leaves the page
        window.addEventListener('beforeunload', this.trackSessionEnd);
        
        // Set up event tracking for UI interactions
        this.setupEventTracking();
      },
      beforeUnmount() {
        // Clean up event listeners
        window.removeEventListener('beforeunload', this.trackSessionEnd);
        
        // Track session end when component is destroyed
        this.trackSessionEnd();
      }
    });
    
    // Initialize the Vue app
    const vueApp = app.mount('#app');
    
    // Set app instance in router now that Vue app is created
    router.setAppInstance(vueApp);
    
    // Make router available globally
    window.router = router;

    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuButton = document.querySelector('.fa-search').parentNode;
      const mobileMenu = document.getElementById('mobile-menu');
      
      if (mobileMenuButton && mobileMenu) {
        mobileMenuButton.addEventListener('click', () => {
          mobileMenu.classList.toggle('hidden');
        });
      }
      
      // Initialize analytics dashboard
      updateAnalyticsDashboard();
    });
  </script>
</body>
</html>